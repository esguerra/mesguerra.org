S=load("A.dat");
E=load("B.dat");
N=10;
i=ones(N,1);
C=(1/(N-1))*((S'*E)-((1/N)*S'*i*i'*E))

M=[C(1,1)+C(2,2)+C(3,3),    C(2,3)-C(3,2),         C(3,1)-C(1,3),            C(1,2)-C(2,1);
      C(2,3)-C(3,2),     C(1,1)-C(2,2)-C(3,3),     C(1,2)+C(2,1),            C(3,1)+C(1,3);
      C(3,1)-C(1,3),        C(1,2)+C(2,1),     -C(1,1)+C(2,2)-C(3,3),        C(2,3)+C(3,2);
      C(1,2)-C(2,1),        C(3,1)+C(1,3),         C(2,3)+C(3,2),       -C(1,1)-C(2,2)+C(3,3)];

[q,lambda]=eig(M)

R=[q(1,4)*q(1,4)+q(2,4)*q(2,4)-q(3,4)*q(3,4)-q(4,4)*q(4,4),    2*(q(2,4)*q(3,4)-q(1,4)*q(4,4)),     2*(q(2,4)*q(4,4)+q(1,4)*q(3,4));
   2*(q(3,4)*q(2,4)+q(1,4)*q(4,4)),   q(1,4)*q(1,4)-q(2,4)*q(2,4)+q(3,4)*q(3,4)-q(4,4)*q(4,4),    2*(q(3,4)*q(4,4)-q(1,4)*q(2,4));
  2*(q(4,4)*q(2,4)-q(1,4)*q(3,4)),  2*(q(4,4)*q(3,4)+q(1,4)*q(2,4)),   q(1,4)*q(1,4)-q(2,4)*q(2,4)-q(3,4)*q(3,4)+q(4,4)*q(4,4)]


x = mean(E) - mean(S)*R'

U = ones(N,1);

O = U*x;

F = (S * R') + O

D = E - F


std (D)
